@page "/secrets"
@using Microsoft.JSInterop
@inject SecretVaultState SecretVaultState

<h3>Secrets</h3>

<SurveyPrompt Title="Secret values should be loaded from this tab and persisted via UserState" />

<form class="was-validated">
	<div class="shadow-none p-3 mb-5 bg-light rounded">
		<h3>JWE Encryption to Visa</h3>
		<div class="form-row">
			<div class="col-md-6 mb-3">
				<label for="jweHeaderKid">JWE Header Kid</label>
				<input type="text" class="form-control" id="jweHeaderKid" @bind="@SecretVaultState.JweHeaderKid" @bind:event="oninput" required>
			</div>
		</div>
		<div class="form-row">
			<div class="mb-3">
				<label for="jwePublicCert">JWE Public Cert</label>
				<textarea class="form-control is-invalid" id="jwePublicCert" placeholder="paste in jwePublicCert .pem or .cert here" @bind="@SecretVaultState.JwePublicCert" required></textarea>
			</div>
		</div>
	</div>
	<div class="shadow-none p-3 mb-5 bg-light rounded">
		<h3>JWS Signing to Visa</h3>
		<div class="form-row">
			<div class="col-md-6 mb-3">
				<label for="jweHeaderKid">JWS Header Kid</label>
				<input type="text" class="form-control" id="jwsHeaderKid" @bind="@SecretVaultState.JwsHeaderKid" @bind:event="oninput" required>
			</div>
		</div>
		<div class="form-row">
			<div class="mb-3">
				<label for="jwsRsaPrivateKey">JWS RSA Private Key</label>
				<textarea class="form-control is-invalid" id="jwsRsaPrivateKey" placeholder="paste in signature signing RSA private key.pem here" @bind="@SecretVaultState.JwsPrivatePem" required></textarea>
			</div>
		</div>
	</div>

	<button type="button" class="btn btn-outline-warning" id="loadRsaKeysBtn" @onclick="LoadRsaKeys">Load RSA Keys</button>

	<div class="position-fixed bottom-0 right-0 p-3" style="z-index: 5; right: 0; bottom: 0;">
		<div id="liveToast" class="toast hide" role="alert" aria-live="assertive" aria-atomic="true" data-delay="2000">
			<div class="toast-header">
				<img src="..." class="rounded mr-2" alt="...">
				<strong class="mr-auto">Bootstrap</strong>
				<small>11 mins ago</small>
				<button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="toast-body">
				Hello, world! This is a toast message.
			</div>
		</div>
	</div>
</form>

<ul>
	<li>@SecretVaultState.JweHeaderKid</li>
	<li>@SecretVaultState.JwePublicCert</li>
	<li>@SecretVaultState.JwsHeaderKid</li>
	<li>@SecretVaultState.JwsPrivatePem</li>
</ul>

@code {
	private void LoadRsaKeys()
	{
		var keyLoadResult = SecretVaultState.LoadRSAKeys();
	}
}
